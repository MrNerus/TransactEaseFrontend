<div class="user-list-container">
  <h2>Users</h2>

  <div class="controls">
    <input type="text" placeholder="Search..." [(ngModel)]="searchTerm" (input)="onSearchChange()">
    <select [(ngModel)]="searchField" (change)="onSearchFieldChange()">
      <option value="all">All Fields</option>
      <option value="fullName">Full Name</option>
      <option value="email">Email</option>
      <option value="organizationId">Organization ID</option>
      <option value="role">Role</option>
    </select>
    <button (click)="addUser()" title="Add New User"><span class="material-icons">add</span></button>
  </div>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Full Name</th>
        <th>Email</th>
        <th>Organization ID</th>
        <th>Role</th>
        <th>Active</th>
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      @for (user of users(); track user.id) {
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.fullName }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.organizationId }}</td>
          <td>{{ user.role }}</td>
          <td>{{ user.isActive ? 'Yes' : 'No' }}</td>
          <td>{{ user.createdAt | date:'short' }}</td>
          <td>
            <button (click)="editUser(user)" title="Edit"><span class="material-icons">edit</span></button>
            <button (click)="deleteUser(user.id)" title="Delete"><span class="material-icons">delete</span></button>
          </td>
        </tr>
      }
      @empty {
        <tr>
          <td colspan="8">No users found.</td>
        </tr>
      }
    </tbody>
  </table>

  <div class="pagination">
    <select [(ngModel)]="pageSize" (change)="onPageSizeChange()">
      @for (option of pageSizeOptions; track option) {
        <option [value]="option">{{ option }} rows</option>
      }
    </select>
    <button (click)="firstPage()" [disabled]="currentPage() === 1" title="First Page"><span class="material-icons">first_page</span></button>
    <button (click)="previousPage()" [disabled]="currentPage() === 1" title="Previous Page"><span class="material-icons">chevron_left</span></button>
    <span>Page
      <input type="number" [(ngModel)]="pageInput" (change)="goToPage()" min="1" [max]="totalPages()">
      of {{ totalPages() }}
    </span>
    <button (click)="nextPage()" [disabled]="currentPage() === totalPages()" title="Next Page"><span class="material-icons">chevron_right</span></button>
    <button (click)="lastPage()" [disabled]="currentPage() === totalPages()" title="Last Page"><span class="material-icons">last_page</span></button>
  </div>
</div>